name: Deploy to Bunny Edge Scripting

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Validate Edge Script
      run: |
        echo "Validating Bunny Edge Script syntax..."
        node -c bunny-edge-script.js
        echo "âœ… Edge Script syntax is valid"
        
    - name: Deploy Script to Bunny Edge Scripting
      if: github.ref == 'refs/heads/main' || github.ref == 'refs/heads/master'
      uses: BunnyWay/actions/deploy-script@main
      with:
        script_id: ${{ secrets.BUNNY_SCRIPT_ID }}
        deployment_key: ${{ secrets.BUNNY_DEPLOYMENT_KEY }}
        file: "bunny-edge-script.js"
